---
title: "PCAを使った異常検知"
date: 2022-10-19T20:06:57+09:00
categories: [""]
tags: [""]

showtoc: true
tocopen: true
searchHidden: false
# cover.image: ""

draft: false
---

## 概要

教師なし学習を使った異常検知をやってみたいと思い
、[Pythonではじめる教師なし学習](https://amzn.to/3eM9dfF)を読んでいたらちょうど
いいお題があったのでやってみることにした

ここではサンプルデータを対象にPCAを使った異常検知を行う

なぜ検出できるのかという理論的な内容についてはここでは触れない。（というかわかっ
てない）

## アプローチ

PCAについて
は[このPDF](https://ojisan-toybox.github.io/universal-pdf-component/example.pdf)が
詳しく書いてあった

前提として、なんらかの理由で訓練データに異常標本が混ざっており、教示データを用意
できないこととする。

（専門家の方には怒られてしまう表現なのは重々承知で、）

上記の資料ではPCAは以下のように説明されている
>多次元データのもつ情報をできるだけ損わずに低次元空間に情報を縮約する方法

この性質を使って、

1. 異常標本が混ざっている多次元データ
2. 1のデータをPCAで次元圧縮し、固有値ベクトルを取得
3. 1と2のデータを使って一度次元圧縮し、復元した逆変換データを作る
4. 元データと逆変換データの差分が大きい値を異常標本として検出する

上記のような処理をすることで、一度PCAをした際に正常なデータの方が多いことが想定されるため、Fitされるベクトルが正常標本に偏りと思われる

その性質を利用して、逆変換をした際に異常標本は正常データに偏って変換されるため元データとの差分が正常標本よりも大きくなると考えられる

## PCA を使った異常検知の実装

[実装したscriptはこちら]()

### ２値分類のサンプルデータを生成

### PCA を使って固有値分解

### 次元圧縮したデータを逆変換

### 元データと逆変換データのサンプルごとに MSE を算出

### MSE が大きい上位 N%のデータを異常値とする

## まとめ
